---
const { type, title = false } = Astro.props;

// Map types to premium styling with CSS classes for dark mode
const styles = {
  note: {
    className: "callout-note",
    icon: "M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" // Pencil/edit icon for notes
  },
  tip: {
    className: "callout-tip",
    icon: "M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" // Lightbulb for tips
  },
  info: {
    className: "callout-info",
    icon: "M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" // Info circle for info
  },
  warning: {
    className: "callout-warning",
    icon: "M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" // Triangle warning
  },
  danger: {
    className: "callout-danger",
    icon: "M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" // X in circle for danger
  },
  link: {
    className: "callout-info singleLineCallout",
    icon: "M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"
  }
};

const style = styles[type] || styles.note;
---

<div class={`callout ${style.className}`}>
  <div class="callout-wrapper">
    <div class="callout-icon">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={style.icon} />
      </svg>
    </div>
    <div class="callout-content">
      {title && <div class="font-semibold mb-1">{title}</div>}
      <slot />
    </div>
  </div>
</div>

<style>
  .callout {
    margin: 1.5rem 0;
    padding: 1rem 1.25rem;
    border-radius: 0.75rem;
    border-width: 1.5px;
    border-style: solid;
    overflow: visible;
  }
  
  .callout-wrapper {
    display: flex;
    align-items: flex-start;
    gap: 0.625rem;
  }

  .singleLineCallout .callout-wrapper {
    align-items: center;
  }
  
  .callout-content {
    flex: 1;
    font-size: 0.875rem;
    line-height: 1.6;
    color: #475569;
    overflow: visible !important;
  }
  
  /* Dark mode text - lighter gray that works with all backgrounds */
  :root.dark .callout-content,
  html.dark .callout-content,
  .dark .callout-content,
  :root.dark .callout .callout-content,
  html.dark .callout .callout-content,
  .dark .callout .callout-content {
    color: #e2e8f0 !important;
  }
  
  .callout-content :global(p) {
    margin: 0;
    line-height: 1.6;
  }
  
  .callout-content :global(a) {
    font-weight: 600;
  }
  
  /* Ensure tooltips work inside callouts by lifting all callouts in the stacking context */
  .callout {
    position: relative;
    z-index: 5; /* Low positive index to sit above standard text but below headers/modals */
  }

  /* Ensure tooltips work inside callouts and are visible */
  .callout :global(.tooltip-popup) {
    z-index: 99999 !important;
  }
  
  /* Ensure strong/bold text is visible too */
  :root.dark .callout-content :global(strong),
  html.dark .callout-content :global(strong),
  .dark .callout-content :global(strong) {
    color: #f8fafc !important;
  }
  
  .callout-icon {
    flex-shrink: 0;
    padding: 0.375rem;
    border-radius: 0.5rem;
    background: color-mix(in srgb, currentColor 10%, transparent);
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .callout-icon svg {
    flex-shrink: 0;
    width: 1.25rem;
    height: 1.25rem;
  }
  
  /* Note - Slate */
  .callout-note {
    background: rgb(248 250 252);
    border-color: rgb(226 232 240);
  }
  
  :root.dark .callout-note,
  html.dark .callout-note,
  .dark .callout-note {
    background: #0a0a0b !important; /* Shade of black as requested */
    border-color: rgb(100 116 139 / 0.4) !important;
  }
  
  .callout-note .callout-icon {
    color: rgb(100 116 139);
  }
  
  :root.dark .callout-note .callout-icon,
  html.dark .callout-note .callout-icon,
  .dark .callout-note .callout-icon {
    color: rgb(226 232 240) !important;
  }
  
  /* Tip - Emerald */
  .callout-tip {
    background: rgb(240 253 248);
    border-color: rgb(209 250 229);
  }
  
  :root.dark .callout-tip,
  html.dark .callout-tip,
  .dark .callout-tip {
    background: #0a0a0b !important; /* Shade of black as requested */
    border-color: rgb(16 185 129 / 0.4) !important;
  }
  
  .callout-tip .callout-icon {
    color: rgb(5 150 105);
  }
  
  :root.dark .callout-tip .callout-icon,
  html.dark .callout-tip .callout-icon,
  .dark .callout-tip .callout-icon {
    color: rgb(52 211 153) !important;
  }

  /* Info - Sky */
  .callout-info {
    background: rgb(240 249 255);
    border-color: rgb(224 242 254);
  }
  
  :root.dark .callout-info,
  html.dark .callout-info,
  .dark .callout-info {
    background: #0a0a0b !important; /* Shade of black as requested */
    border-color: rgb(14 165 233 / 0.4) !important;
  }
  
  .callout-info .callout-icon {
    color: rgb(2 132 199);
  }
  
  :root.dark .callout-info .callout-icon,
  html.dark .callout-info .callout-icon,
  .dark .callout-info .callout-icon {
    color: rgb(56 189 248) !important;
  }
  
  /* Warning - Amber */
  .callout-warning {
    background: rgb(255 251 235);
    border-color: rgb(254 243 199);
  }
  
  :root.dark .callout-warning,
  html.dark .callout-warning,
  .dark .callout-warning {
    background: #0a0a0b !important; /* Shade of black as requested */
    border-color: rgb(245 158 11 / 0.4) !important;
  }
  
  .callout-warning .callout-icon {
    color: rgb(217 119 6);
  }
  
  :root.dark .callout-warning .callout-icon,
  html.dark .callout-warning .callout-icon,
  .dark .callout-warning .callout-icon {
    color: rgb(251 191 36) !important;
  }

  /* Danger - Rose */
  .callout-danger {
    background: rgb(255 241 242);
    border-color: rgb(254 205 211);
  }
  
  :root.dark .callout-danger,
  html.dark .callout-danger,
  .dark .callout-danger {
    background: #0a0a0b !important; /* Shade of black as requested */
    border-color: rgb(244 63 94 / 0.4) !important;
  }
  
  .callout-danger .callout-icon {
    color: rgb(244 63 94);
  }
  
  :root.dark .callout-danger .callout-icon,
  html.dark .callout-danger .callout-icon,
  .dark .callout-danger .callout-icon {
    color: rgb(253 164 175) !important;
  }
</style>

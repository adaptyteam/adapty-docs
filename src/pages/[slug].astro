---
import DocsLayout from '../layouts/DocsLayout.astro';
import ApiReferencePage from '../components/ApiReferencePage.astro';
import apiConfig from '../api-reference/config.json';

export async function getStaticPaths() {
  return apiConfig.map((api) => ({
    params: { slug: api.slug },
    props: { api },
  }));
}

const { api } = Astro.props;
const { slug } = Astro.params;

const specUrl = api.specUrl || `${import.meta.env.BASE_URL}/api-specs/${api.specFile}`.replace(/\/+/g, '/');
const basePath = `${import.meta.env.BASE_URL}/${slug}`.replace(/\/+/g, '/');

// Breadcrumbs for API Reference
const breadcrumbs = [
  { label: 'Home', href: `${import.meta.env.BASE_URL}/`.replace(/\/+/g, '/') },
  { label: api.name }
];
---

<DocsLayout
  title={api.name}
  sidebarData={null}
  currentPlatformId="api"
  currentSlug={slug}
  breadcrumbs={breadcrumbs}
  isFullWidth={true}
>
  <ApiReferencePage api={api} slug={slug} specUrl={specUrl} basePath={basePath} />
</DocsLayout>
